<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/sword_at_offer/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/sword_at_offer/static/css/tango.css">
    <link rel="shortcut icon" href="/sword_at_offer/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/sword_at_offer/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>python时间处理相关 - 剑指Offer</title>
    <meta name="keywords" content="algorithm，python"/>
    <meta name="description" content="for python and algorithm"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/sword_at_offer/">Home</a>&nbsp;&#187;&nbsp;<a href="/sword_at_offer/#python">python</a>&nbsp;&#187;&nbsp;python时间处理相关
    <span class="updated">Page Updated&nbsp;
      2018-11-14 00:00
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">python时间处理相关</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">时间处理</a><ul>
<li><a href="#time">time</a></li>
<li><a href="#datetime-time">datetime &amp; time</a></li>
<li><a href="#calendar">calendar</a></li>
<li><a href="#_2">统计函数执行时间(装饰器)</a></li>
<li><a href="#2">统计函数执行时间(装饰器)2</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="_1">时间处理</h1>
<p>三个重要的模块：<code>time</code>,<code>datetime</code>,<code>calendar</code>, 时间处理基本上各种开发都要得到(一般在项目的工具包中)，如下是三个时间模块的说明文档</p>
<p>https://docs.python.org/2/library/datetime.html#module-datetime</p>
<p>https://docs.python.org/2/library/time.html</p>
<p>https://docs.python.org/2/library/calendar.html#module-calendar</p>
<h2 id="time">time</h2>
<div class="hlcode"><pre><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Return the time in seconds since the epoch as a floating point number. Note that even though the time is always returned as a floating point number, not all systems provide time with a better precision than 1 second. While this function normally returns non-decreasing values, it can return a lower value than a previous call if the system clock has been set back between the two calls.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>


<div class="hlcode"><pre><span class="c"># -*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c"># 当前时间戳，float类型</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>

    <span class="c"># 当前时间，格式自定义，字符串类型</span>
    <span class="n">local_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
    <span class="n">local_time_str</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">local_time</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">local_time_str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">local_time_str</span><span class="p">))</span>
</pre></div>


<h2 id="datetime-time">datetime &amp; time</h2>
<div class="hlcode"><pre><span class="c"># -*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">t_obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_obj</span><span class="p">))</span>

    <span class="n">t_str</span> <span class="o">=</span> <span class="n">t_obj</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">t_str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_str</span><span class="p">))</span>

    <span class="n">timestamp1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">timestamp1</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">timestamp1</span><span class="p">))</span>
    <span class="c"># float 时间戳， 同 time.time()</span>
    <span class="n">un_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">timestamp1</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="n">un_time</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">un_time</span><span class="p">))</span>

    <span class="c"># 秒级别的时间戳</span>
    <span class="n">sec_unixtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">un_time</span><span class="p">)</span>
    <span class="c"># 毫秒级的时间戳</span>
    <span class="n">millis_unixtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sec_unixtime</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">millis_unixtime</span><span class="p">)</span>
</pre></div>


<h2 id="calendar">calendar</h2>
<div class="hlcode"><pre><span class="c"># -*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">calendar</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">cal</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span>

    <span class="n">day_code</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>
    <span class="n">week_arr</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;星期一&#39;</span><span class="p">,</span> <span class="s">&#39;星期二&#39;</span><span class="p">,</span> <span class="s">&#39;星期三&#39;</span><span class="p">,</span> <span class="s">&#39;星期四&#39;</span><span class="p">,</span> <span class="s">&#39;星期五&#39;</span><span class="p">,</span> <span class="s">&#39;星期六&#39;</span><span class="p">,</span> <span class="s">&#39;星期日&#39;</span><span class="p">]</span>
    <span class="n">week</span> <span class="o">=</span> <span class="n">week_arr</span><span class="p">[</span><span class="n">day_code</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">week</span><span class="p">)</span>
</pre></div>


<h2 id="_2">统计函数执行时间(装饰器)</h2>
<div class="hlcode"><pre><span class="c"># -*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">def</span> <span class="nf">debug_time</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span>
        <span class="k">print</span> <span class="s">&quot;[DEBUG_TIME]: enter {}()&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="c"># 毫秒级的时间戳</span>
        <span class="n">start_millis_unixtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="c"># 执行函数</span>
        <span class="n">func</span><span class="p">()</span>
        <span class="n">end_millis_unixtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="n">span</span> <span class="o">=</span> <span class="n">end_millis_unixtime</span> <span class="o">-</span> <span class="n">start_millis_unixtime</span>
        <span class="k">print</span> <span class="s">&quot;[DEBUG_TIME]: {} cost {}ms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">span</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>  <span class="c"># 返回包装过函数</span>


<span class="nd">@debug_time</span>
<span class="k">def</span> <span class="nf">fun_sleep</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">&quot;func start&quot;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;func end&quot;</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">fun_sleep</span><span class="p">()</span>
</pre></div>


<h2 id="2">统计函数执行时间(装饰器)2</h2>
<div class="hlcode"><pre><span class="c"># -*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">functools</span>

<span class="k">class</span> <span class="nc">Log</span><span class="p">:</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">debug_time</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>

        <span class="nd">@functools.wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">&quot;[DEBUG_TIME]: enter {}()&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            <span class="c"># 毫秒级的时间戳</span>
            <span class="n">start_millis_unixtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
            <span class="c"># 原函数调用</span>
            <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">end_millis_unixtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
            <span class="n">span</span> <span class="o">=</span> <span class="n">end_millis_unixtime</span> <span class="o">-</span> <span class="n">start_millis_unixtime</span>
            <span class="k">print</span> <span class="s">&quot;[DEBUG_TIME]: {} cost {}ms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">span</span><span class="p">)</span>

        <span class="c"># 返回一个包装函数</span>
        <span class="k">return</span> <span class="n">wrapper</span>


<span class="nd">@Log.debug_time</span>
<span class="k">def</span> <span class="nf">fun_sleep</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;func start&quot;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;func end&quot;</span>


<span class="nd">@Log.debug_time</span>
<span class="k">def</span> <span class="nf">fun_sleep_sh</span><span class="p">(</span><span class="n">something</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;func start {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;func end {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">fun_sleep</span><span class="p">()</span>
    <span class="n">fun_sleep_sh</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
</pre></div>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2019 doctording.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2019-05-04 22:41:22</p>
      </span>
    </div>

    
    
  </body>
</html>