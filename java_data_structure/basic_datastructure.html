<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/sword_at_offer/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/sword_at_offer/static/css/tango.css">
    <link rel="shortcut icon" href="/sword_at_offer/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/sword_at_offer/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>Java 基础数据结构 - 剑指Offer</title>
    <meta name="keywords" content="algorithm，python"/>
    <meta name="description" content="for python and algorithm"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/sword_at_offer/">Home</a>&nbsp;&#187;&nbsp;<a href="/sword_at_offer/#java_data_structure">java_data_structure</a>&nbsp;&#187;&nbsp;Java 基础数据结构
    <span class="updated">Page Updated&nbsp;
      2019-05-25 00:00
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">Java 基础数据结构</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#java">Java常用数据结构和原理</a><ul>
<li><a href="#map-mapentryinterface">Map Map.Entry<K,V>(interface)</a></li>
<li><a href="#abstractmapabstract-class">AbstractMap(abstract class)</a></li>
<li><a href="#hashmapclass">HashMap(class)</a><ul>
<li><a href="#java88">底层实现是数组+链表（Java8中链表长度超过8个会转换为树结构）</a><ul>
<li><a href="#_1">单链表结构</a></li>
<li><a href="#_2">树结构</a></li>
</ul>
</li>
<li><a href="#null-key-null-val">null key(可以)， null val(可以) 与 实际例子</a></li>
<li><a href="#keyhashnullhash0">key的hash方法(null的hash值设置成了0)</a></li>
<li><a href="#put">put 方法</a></li>
<li><a href="#_3">非线程安全</a></li>
<li><a href="#_4">遍历的无序性</a></li>
</ul>
</li>
<li><a href="#hashtableclass">Hashtable(class)</a><ul>
<li><a href="#mapdictionary">实现了Map，继承了Dictionary，底层数组(散列表)+链表(拉链法)</a></li>
<li><a href="#null-key-null-value">null key, null value（不可以）</a></li>
<li><a href="#synchronized">线程安全，基本上操作方法都加上了synchronized关键字</a></li>
<li><a href="#put_1">put方法</a></li>
</ul>
</li>
<li><a href="#linkedhashmapclass">LinkedHashMap(class)</a><ul>
<li><a href="#hashmap">底层是HashMap,并维持一个双向链表</a></li>
<li><a href="#_5">遍历的有序性</a></li>
<li><a href="#null-keynull-value">非线程安全，可以null key,null value等</a></li>
</ul>
</li>
<li><a href="#sortedmapinterface">SortedMap（interface）</a><ul>
<li><a href="#_6">元素遍历可以按键的排序顺序进行</a></li>
</ul>
</li>
<li><a href="#navigablemap-interface">NavigableMap (interface)</a><ul>
<li><a href="#_7">方法</a></li>
</ul>
</li>
<li><a href="#treemap">TreeMap(类)</a><ul>
<li><a href="#_8">底层基于红黑树</a></li>
<li><a href="#null-key-null-value_1">不允许 null key， 可以 null value</a></li>
<li><a href="#keycomparator">key排序，可以指定comparator</a></li>
</ul>
</li>
<li><a href="#listinterface">List(interface)</a><ul>
<li><a href="#list-collection">List 继承自 Collection，其添加了以下操作方法</a></li>
</ul>
</li>
<li><a href="#queueinterface">Queue(interface) 普通队列</a><ul>
<li><a href="#queue">Queue接口的基础方法</a></li>
<li><a href="#_9">使用例子</a></li>
</ul>
</li>
<li><a href="#dequeinterface-queue">Deque(interface) 双向队列，继承了Queue</a></li>
<li><a href="#arraylistclass">ArrayList(class) 数组</a></li>
<li><a href="#linkedlistclasslist-deque">LinkedList(class)链表(同时实现了List 和 Deque接口)</a><ul>
<li><a href="#node">内部的Node结构(双向链表)</a></li>
</ul>
</li>
<li><a href="#vectorclass">Vector(class)线程安全的数组</a><ul>
<li><a href="#synchronized_1">线程安全,操作方法基本加上了synchronized关键字</a></li>
</ul>
</li>
<li><a href="#priorityqueueclass">PriorityQueue(class) 优先队列</a><ul>
<li><a href="#_10">实例</a></li>
</ul>
</li>
<li><a href="#stackclass">Stack(class)</a><ul>
<li><a href="#vector">继承了Vector, 基于数组，线程安全</a></li>
</ul>
</li>
<li><a href="#setinterface">Set(interface)</a></li>
<li><a href="#hashsetclass">HashSet(class)</a><ul>
<li><a href="#hashmap-key">底层基于 HashMap, key不同</a></li>
<li><a href="#null-hasmapnull-key">允许元素为null (因为HasMap允许null key)</a></li>
</ul>
</li>
<li><a href="#linkedhashsetclass">LinkedHashSet(class)</a><ul>
<li><a href="#set">具有set集合不重复的特点，同时具有可预测的迭代顺序</a></li>
<li><a href="#_11">非线程安全</a></li>
</ul>
</li>
<li><a href="#sortedsetinterface">SortedSet(interface)</a></li>
<li><a href="#navigablesetinterface-sortedset">NavigableSet(interface) 继承 SortedSet</a></li>
<li><a href="#treesetclass-sortedset">TreeSet(class) 唯一实现了SortedSet的</a><ul>
<li><a href="#null">不允许 null 值</a></li>
<li><a href="#_12">非线程安全，树结构</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="java">Java常用数据结构和原理</h1>
<h2 id="map-mapentryinterface">Map Map.Entry<K,V>(interface)</h2>
<h2 id="abstractmapabstract-class">AbstractMap(abstract class)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<p>实现一些Map的基础方法</p>
<h2 id="hashmapclass">HashMap(class)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">Serializable</span> <span class="o">{</span>
</pre></div>


<h3 id="java88">底层实现是<code>数组+链表</code>（Java8中链表长度超过8个会转换为树结构）</h3>
<div class="hlcode"><pre> <span class="cm">/* ---------------- Fields -------------- */</span>

    <span class="cm">/**</span>
<span class="cm">     * The table, initialized on first use, and resized as</span>
<span class="cm">     * necessary. When allocated, length is always a power of two.</span>
<span class="cm">     * (We also tolerate length zero in some operations to allow</span>
<span class="cm">     * bootstrapping mechanics that are currently not needed.)</span>
<span class="cm">     */</span>
    <span class="kd">transient</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;[]</span> <span class="n">table</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Holds cached entrySet(). Note that AbstractMap fields are used</span>
<span class="cm">     * for keySet() and values().</span>
<span class="cm">     */</span>
    <span class="kd">transient</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">entrySet</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The number of key-value mappings contained in this map.</span>
<span class="cm">     */</span>
    <span class="kd">transient</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The number of times this HashMap has been structurally modified</span>
<span class="cm">     * Structural modifications are those that change the number of mappings in</span>
<span class="cm">     * the HashMap or otherwise modify its internal structure (e.g.,</span>
<span class="cm">     * rehash).  This field is used to make iterators on Collection-views of</span>
<span class="cm">     * the HashMap fail-fast.  (See ConcurrentModificationException).</span>
<span class="cm">     */</span>
    <span class="kd">transient</span> <span class="kt">int</span> <span class="n">modCount</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The next size value at which to resize (capacity * load factor).</span>
<span class="cm">     *</span>
<span class="cm">     * @serial</span>
<span class="cm">     */</span>
    <span class="c1">// (The javadoc description is true upon serialization.</span>
    <span class="c1">// Additionally, if the table array has not been allocated, this</span>
    <span class="c1">// field holds the initial array capacity, or zero signifying</span>
    <span class="c1">// DEFAULT_INITIAL_CAPACITY.)</span>
    <span class="kt">int</span> <span class="n">threshold</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The load factor for the hash table.</span>
<span class="cm">     *</span>
<span class="cm">     * @serial</span>
<span class="cm">     */</span>
    <span class="kd">final</span> <span class="kt">float</span> <span class="n">loadFactor</span><span class="o">;</span>
</pre></div>


<h4 id="_1">单链表结构</h4>
<div class="hlcode"><pre> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="kt">int</span> <span class="n">hash</span><span class="o">;</span>
    <span class="kd">final</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>
    <span class="n">V</span> <span class="n">value</span><span class="o">;</span>
    <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>

    <span class="n">Node</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span> <span class="n">hash</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="n">K</span> <span class="nf">getKey</span><span class="o">()</span>        <span class="o">{</span> <span class="k">return</span> <span class="n">key</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="n">V</span> <span class="nf">getValue</span><span class="o">()</span>      <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">key</span> <span class="o">+</span> <span class="s">&quot;=&quot;</span> <span class="o">+</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Objects</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">key</span><span class="o">)</span> <span class="o">^</span> <span class="n">Objects</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="n">V</span> <span class="nf">setValue</span><span class="o">(</span><span class="n">V</span> <span class="n">newValue</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="o">==</span> <span class="k">this</span><span class="o">)</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="k">instanceof</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;?,?&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;?,?&gt;)</span><span class="n">o</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getKey</span><span class="o">())</span> <span class="o">&amp;&amp;</span>
                <span class="n">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">()))</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h4 id="_2">树结构</h4>
<div class="hlcode"><pre><span class="cm">/**</span>
<span class="cm">* Entry for Tree bins. Extends LinkedHashMap.Entry (which in turn</span>
<span class="cm">* extends Node) so can be used as extension of either regular or</span>
<span class="cm">* linked node.</span>
<span class="cm">*/</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">parent</span><span class="o">;</span>  <span class="c1">// red-black tree links</span>
    <span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">left</span><span class="o">;</span>
    <span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">right</span><span class="o">;</span>
    <span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">prev</span><span class="o">;</span>    <span class="c1">// needed to unlink next upon deletion</span>
    <span class="kt">boolean</span> <span class="n">red</span><span class="o">;</span>
    <span class="n">TreeNode</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">val</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">,</span> <span class="n">next</span><span class="o">);</span>
    <span class="o">}</span>
</pre></div>


<h3 id="null-key-null-val">null key(可以)， null val(可以) 与 实际例子</h3>
<div class="hlcode"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span><span class="n">val</span><span class="o">)-&gt;{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;&lt;%s,%s&gt;&quot;</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">));</span>
<span class="o">});</span>
</pre></div>


<ul>
<li>output</li>
</ul>
<div class="hlcode"><pre><span class="o">&lt;</span><span class="kc">null</span><span class="o">,</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">a</span><span class="o">,</span><span class="kc">null</span><span class="o">&gt;</span>
</pre></div>


<h3 id="keyhashnullhash0">key的hash方法(null的hash值设置成了0)</h3>
<div class="hlcode"><pre><span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nf">hash</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">h</span><span class="o">;</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">key</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">(</span><span class="n">h</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())</span> <span class="o">^</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">16</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>


<h3 id="put">put 方法</h3>
<div class="hlcode"><pre> <span class="kd">final</span> <span class="n">V</span> <span class="nf">putVal</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">onlyIfAbsent</span><span class="o">,</span>
                <span class="kt">boolean</span> <span class="n">evict</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;[]</span> <span class="n">tab</span><span class="o">;</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span><span class="o">;</span> <span class="kt">int</span> <span class="n">n</span><span class="o">,</span> <span class="n">i</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">((</span><span class="n">tab</span> <span class="o">=</span> <span class="n">table</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">(</span><span class="n">tab</span> <span class="o">=</span> <span class="n">resize</span><span class="o">()).</span><span class="na">length</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">((</span><span class="n">p</span> <span class="o">=</span> <span class="n">tab</span><span class="o">[</span><span class="n">i</span> <span class="o">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">hash</span><span class="o">])</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="c1">// 数组的位置上是否存在元素，否则数组的位置上创建节点</span>
        <span class="n">tab</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">newNode</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span><span class="o">;</span> <span class="n">K</span> <span class="n">k</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span>
            <span class="o">((</span><span class="n">k</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">==</span> <span class="n">key</span> <span class="o">||</span> <span class="o">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">))))</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">p</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="o">)</span> <span class="c1">// 数组的位置上节点不是单链表了，而是树</span>
            <span class="n">e</span> <span class="o">=</span> <span class="o">((</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;)</span><span class="n">p</span><span class="o">).</span><span class="na">putTreeVal</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">tab</span><span class="o">,</span> <span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">binCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="o">;</span> <span class="o">++</span><span class="n">binCount</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">((</span><span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">p</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">newNode</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                    <span class="c1">// 超过8个的链表 转换为树结构</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">binCount</span> <span class="o">&gt;=</span> <span class="n">TREEIFY_THRESHOLD</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="c1">// -1 for 1st</span>
                        <span class="n">treeifyBin</span><span class="o">(</span><span class="n">tab</span><span class="o">,</span> <span class="n">hash</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span>
                    <span class="o">((</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">==</span> <span class="n">key</span> <span class="o">||</span> <span class="o">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">))))</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// existing mapping for key</span>
            <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">onlyIfAbsent</span> <span class="o">||</span> <span class="n">oldValue</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
                <span class="n">e</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
            <span class="n">afterNodeAccess</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="o">++</span><span class="n">modCount</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(++</span><span class="n">size</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="o">)</span> <span class="c1">// 超过平衡因子，数组扩容</span>
        <span class="n">resize</span><span class="o">();</span>
    <span class="n">afterNodeInsertion</span><span class="o">(</span><span class="n">evict</span><span class="o">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<h3 id="_3">非线程安全</h3>
<h3 id="_4">遍历的无序性</h3>
<div class="hlcode"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">iteratorMap</span> <span class="o">=</span> <span class="n">entries</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">iteratorMap</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
            <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">next</span> <span class="o">=</span> <span class="n">iteratorMap</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">)-&gt;{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%s=%s&quot;</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span><span class="n">val</span><span class="o">));</span>
        <span class="o">});</span>
<span class="cm">/* output</span>
<span class="cm">null=a</span>
<span class="cm">a=a</span>
<span class="cm">b=null</span>
<span class="cm">*/</span>
</pre></div>


<h2 id="hashtableclass">Hashtable(class)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hashtable</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">Dictionary</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{</span>
</pre></div>


<h3 id="mapdictionary">实现了Map，继承了Dictionary，底层数组(散列表)+链表(拉链法)</h3>
<div class="hlcode"><pre><span class="cm">/**</span>
<span class="cm">    * The hash table data.</span>
<span class="cm">    */</span>
<span class="kd">private</span> <span class="kd">transient</span> <span class="n">Entry</span><span class="o">&lt;?,?&gt;[]</span> <span class="n">table</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm">    * The total number of entries in the hash table.</span>
<span class="cm">    */</span>
<span class="kd">private</span> <span class="kd">transient</span> <span class="kt">int</span> <span class="n">count</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm">    * The table is rehashed when its size exceeds this threshold.  (The</span>
<span class="cm">    * value of this field is (int)(capacity * loadFactor).)</span>
<span class="cm">    *</span>
<span class="cm">    * @serial</span>
<span class="cm">    */</span>
<span class="kd">private</span> <span class="kt">int</span> <span class="n">threshold</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm">    * The load factor for the hashtable.</span>
<span class="cm">    *</span>
<span class="cm">    * @serial</span>
<span class="cm">    */</span>
<span class="kd">private</span> <span class="kt">float</span> <span class="n">loadFactor</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm">    * The number of times this Hashtable has been structurally modified</span>
<span class="cm">    * Structural modifications are those that change the number of entries in</span>
<span class="cm">    * the Hashtable or otherwise modify its internal structure (e.g.,</span>
<span class="cm">    * rehash).  This field is used to make iterators on Collection-views of</span>
<span class="cm">    * the Hashtable fail-fast.  (See ConcurrentModificationException).</span>
<span class="cm">    */</span>
<span class="kd">private</span> <span class="kd">transient</span> <span class="kt">int</span> <span class="n">modCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

<span class="cm">/** use serialVersionUID from JDK 1.0.2 for interoperability */</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1421746759512286392L</span><span class="o">;</span>
</pre></div>


<h3 id="null-key-null-value">null key, null value（不可以）</h3>
<ul>
<li>Java8程序</li>
</ul>
<div class="hlcode"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Hashtable</span><span class="o">&lt;&gt;();</span>
<span class="c1">// key value 都不能为null，否则java.lang.NullPointerException</span>
<span class="c1">//        mp.put(null, null);</span>
<span class="c1">//        mp.put(null, &quot;a&quot;);</span>
<span class="c1">//        mp.put(&quot;a&quot;, null);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span><span class="n">val</span><span class="o">)-&gt;{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;&lt;%s,%s&gt;&quot;</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">));</span>
<span class="o">});</span>
</pre></div>


<h3 id="synchronized">线程安全，基本上操作方法都加上了<code>synchronized</code>关键字</h3>
<h3 id="put_1">put方法</h3>
<div class="hlcode"><pre> <span class="cm">/**</span>
<span class="cm">     * Maps the specified &lt;code&gt;key&lt;/code&gt; to the specified</span>
<span class="cm">     * &lt;code&gt;value&lt;/code&gt; in this hashtable. Neither the key nor the</span>
<span class="cm">     * value can be &lt;code&gt;null&lt;/code&gt;. &lt;p&gt;</span>
<span class="cm">     *</span>
<span class="cm">     * The value can be retrieved by calling the &lt;code&gt;get&lt;/code&gt; method</span>
<span class="cm">     * with a key that is equal to the original key.</span>
<span class="cm">     *</span>
<span class="cm">     * @param      key     the hashtable key</span>
<span class="cm">     * @param      value   the value</span>
<span class="cm">     * @return     the previous value of the specified key in this hashtable,</span>
<span class="cm">     *             or &lt;code&gt;null&lt;/code&gt; if it did not have one</span>
<span class="cm">     * @exception  NullPointerException  if the key or value is</span>
<span class="cm">     *               &lt;code&gt;null&lt;/code&gt;</span>
<span class="cm">     * @see     Object#equals(Object)</span>
<span class="cm">     * @see     #get(Object)</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="n">V</span> <span class="nf">put</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Make sure the value is not null</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NullPointerException</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="c1">// Makes sure the key is not already in the hashtable.</span>
        <span class="n">Entry</span><span class="o">&lt;?,?&gt;</span> <span class="n">tab</span><span class="o">[]</span> <span class="o">=</span> <span class="n">table</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="o">(</span><span class="n">hash</span> <span class="o">&amp;</span> <span class="mh">0x7FFFFFFF</span><span class="o">)</span> <span class="o">%</span> <span class="n">tab</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&quot;unchecked&quot;</span><span class="o">)</span>
        <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">=</span> <span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;)</span><span class="n">tab</span><span class="o">[</span><span class="n">index</span><span class="o">];</span>
        <span class="k">for</span><span class="o">(;</span> <span class="n">entry</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">;</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">((</span><span class="n">entry</span><span class="o">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">entry</span><span class="o">.</span><span class="na">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">V</span> <span class="n">old</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
                <span class="n">entry</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
                <span class="k">return</span> <span class="n">old</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="n">addEntry</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">index</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
</pre></div>


<h2 id="linkedhashmapclass">LinkedHashMap(class)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
<span class="o">{</span>
</pre></div>


<h3 id="hashmap">底层是HashMap,并维持一个双向链表</h3>
<div class="hlcode"><pre> <span class="cm">/**</span>
<span class="cm">     * HashMap.Node subclass for normal LinkedHashMap entries.</span>
<span class="cm">     */</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">HashMap</span><span class="o">.</span><span class="na">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">before</span><span class="o">,</span> <span class="n">after</span><span class="o">;</span>
        <span class="n">Entry</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">next</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">3801124242820219131L</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The head (eldest) of the doubly linked list.</span>
<span class="cm">     */</span>
    <span class="kd">transient</span> <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">head</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The tail (youngest) of the doubly linked list.</span>
<span class="cm">     */</span>
    <span class="kd">transient</span> <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">tail</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The iteration ordering method for this linked hash map: &lt;tt&gt;true&lt;/tt&gt;</span>
<span class="cm">     * for access-order, &lt;tt&gt;false&lt;/tt&gt; for insertion-order.</span>
<span class="cm">     *</span>
<span class="cm">     * @serial</span>
<span class="cm">     */</span>
    <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">accessOrder</span><span class="o">;</span>

    <span class="c1">// internal utilities</span>

    <span class="c1">// link at the end of list</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">linkNodeLast</span><span class="o">(</span><span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">last</span> <span class="o">=</span> <span class="n">tail</span><span class="o">;</span>
        <span class="n">tail</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">last</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">p</span><span class="o">.</span><span class="na">before</span> <span class="o">=</span> <span class="n">last</span><span class="o">;</span>
            <span class="n">last</span><span class="o">.</span><span class="na">after</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// apply src&#39;s links to dst</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">transferLinks</span><span class="o">(</span><span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">src</span><span class="o">,</span>
                               <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">dst</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">dst</span><span class="o">.</span><span class="na">before</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="na">before</span><span class="o">;</span>
        <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">dst</span><span class="o">.</span><span class="na">after</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="na">after</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">dst</span><span class="o">;</span>
        <span class="k">else</span>
            <span class="n">b</span><span class="o">.</span><span class="na">after</span> <span class="o">=</span> <span class="n">dst</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">dst</span><span class="o">;</span>
        <span class="k">else</span>
            <span class="n">a</span><span class="o">.</span><span class="na">before</span> <span class="o">=</span> <span class="n">dst</span><span class="o">;</span>
    <span class="o">}</span>
</pre></div>


<h3 id="_5">遍历的有序性</h3>
<div class="hlcode"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">iteratorMap</span> <span class="o">=</span> <span class="n">entries</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">iteratorMap</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
            <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">next</span> <span class="o">=</span> <span class="n">iteratorMap</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">)-&gt;{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%s=%s&quot;</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span><span class="n">val</span><span class="o">));</span>
        <span class="o">});</span>
<span class="cm">/* output</span>
<span class="cm">null=a</span>
<span class="cm">b=null</span>
<span class="cm">a=a</span>
<span class="cm">*/</span>
</pre></div>


<h3 id="null-keynull-value">非线程安全，可以null key,null value等</h3>
<h2 id="sortedmapinterface">SortedMap（interface）</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SortedMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h3 id="_6">元素遍历可以按键的排序顺序进行</h3>
<h2 id="navigablemap-interface">NavigableMap (interface)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NavigableMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">SortedMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h3 id="_7">方法</h3>
<div class="hlcode"><pre><span class="c1">// 找到第一个比指定的key小的值</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">lowerEntry</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="c1">// 找到第一个比指定的key小的key</span>
<span class="n">K</span> <span class="nf">lowerKey</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="c1">// 找到第一个小于或等于指定key的值</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">floorEntry</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="c1">// 找到第一个小于或等于指定key的key</span>
<span class="n">K</span> <span class="nf">floorKey</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="c1">//  找到第一个大于或等于指定key的值</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">ceilingEntry</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="n">K</span> <span class="nf">ceilingKey</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="c1">// 找到第一个大于指定key的值</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">higherEntry</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="n">K</span> <span class="nf">higherKey</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">);</span>

<span class="c1">// 获取最小值</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">firstEntry</span><span class="o">();</span>

<span class="c1">// 获取最大值</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">lastEntry</span><span class="o">();</span>

<span class="c1">// 删除最小的元素</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">pollFirstEntry</span><span class="o">();</span>

<span class="c1">// 删除最大的元素</span>
<span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">pollLastEntry</span><span class="o">();</span>

<span class="c1">//返回一个倒序的Map</span>
<span class="n">NavigableMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">descendingMap</span><span class="o">();</span>

<span class="c1">// 返回一个Navigable的key的集合，NavigableSet和NavigableMap类似</span>
<span class="n">NavigableSet</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="nf">navigableKeySet</span><span class="o">();</span>

<span class="c1">// 对上述集合倒序</span>
<span class="n">NavigableSet</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="nf">descendingKeySet</span><span class="o">();</span>
</pre></div>


<h2 id="treemap">TreeMap(类)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TreeMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">AbstractMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">NavigableMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span>
<span class="o">{</span>
</pre></div>


<h3 id="_8">底层基于红黑树</h3>
<p>红黑树能保证增、删、查等基本操作的时间复杂度为O(lgN)</p>
<div class="hlcode"><pre> <span class="cm">/**</span>
<span class="cm">     * The comparator used to maintain order in this tree map, or</span>
<span class="cm">     * null if it uses the natural ordering of its keys.</span>
<span class="cm">     *</span>
<span class="cm">     * @serial</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Comparator</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">K</span><span class="o">&gt;</span> <span class="n">comparator</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">transient</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">root</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The number of entries in the tree</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">transient</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * The number of structural modifications to the tree.</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">transient</span> <span class="kt">int</span> <span class="n">modCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</pre></div>


<h3 id="null-key-null-value_1">不允许 null key， 可以 null value</h3>
<h3 id="keycomparator">key排序，可以指定comparator</h3>
<div class="hlcode"><pre><span class="n">Comparator</span> <span class="n">comparator</span> <span class="o">=</span>  <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">vala</span> <span class="o">=</span> <span class="o">((</span><span class="n">Integer</span><span class="o">)</span><span class="n">a</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">valb</span> <span class="o">=</span> <span class="o">((</span><span class="n">Integer</span><span class="o">)</span><span class="n">b</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">vala</span> <span class="o">&gt;</span> <span class="n">valb</span><span class="o">){</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">vala</span> <span class="o">&lt;</span> <span class="n">valb</span><span class="o">){</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">};</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeMap</span><span class="o">(</span><span class="n">comparator</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;a&quot;</span><span class="o">);</span>
<span class="n">mp</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">)-&gt;{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%d=%s&quot;</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span><span class="n">val</span><span class="o">));</span>
<span class="o">});</span>
</pre></div>


<h2 id="listinterface">List(interface)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h3 id="list-collection">List 继承自 Collection，其添加了以下操作方法</h3>
<ul>
<li>位置相关：List 的元素是有序的，因此有get(index)、set(index,object)、add(index,object)、remove(index) 方法。</li>
<li>搜索：indexOf()，lastIndexOf();</li>
<li>迭代：使用 Iterator 的功能板迭代器</li>
<li>范围性操作：使用 subList 方法对 list 进行任意范围操作。</li>
</ul>
<h2 id="queueinterface">Queue(interface) 普通队列</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Queue</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h3 id="queue">Queue接口的基础方法</h3>
<div class="hlcode"><pre> <span class="cm">/**</span>
<span class="cm">     * Inserts the specified element into this queue if it is possible to do so</span>
<span class="cm">     * immediately without violating capacity restrictions, returning</span>
<span class="cm">     * {@code true} upon success and throwing an {@code IllegalStateException}</span>
<span class="cm">     * if no space is currently available.</span>
<span class="cm">     *</span>
<span class="cm">     * @param e the element to add</span>
<span class="cm">     * @return {@code true} (as specified by {@link Collection#add})</span>
<span class="cm">     * @throws IllegalStateException if the element cannot be added at this</span>
<span class="cm">     *         time due to capacity restrictions</span>
<span class="cm">     * @throws ClassCastException if the class of the specified element</span>
<span class="cm">     *         prevents it from being added to this queue</span>
<span class="cm">     * @throws NullPointerException if the specified element is null and</span>
<span class="cm">     *         this queue does not permit null elements</span>
<span class="cm">     * @throws IllegalArgumentException if some property of this element</span>
<span class="cm">     *         prevents it from being added to this queue</span>
<span class="cm">     */</span>
    <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">E</span> <span class="n">e</span><span class="o">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Inserts the specified element into this queue if it is possible to do</span>
<span class="cm">     * so immediately without violating capacity restrictions.</span>
<span class="cm">     * When using a capacity-restricted queue, this method is generally</span>
<span class="cm">     * preferable to {@link #add}, which can fail to insert an element only</span>
<span class="cm">     * by throwing an exception.</span>
<span class="cm">     *</span>
<span class="cm">     * @param e the element to add</span>
<span class="cm">     * @return {@code true} if the element was added to this queue, else</span>
<span class="cm">     *         {@code false}</span>
<span class="cm">     * @throws ClassCastException if the class of the specified element</span>
<span class="cm">     *         prevents it from being added to this queue</span>
<span class="cm">     * @throws NullPointerException if the specified element is null and</span>
<span class="cm">     *         this queue does not permit null elements</span>
<span class="cm">     * @throws IllegalArgumentException if some property of this element</span>
<span class="cm">     *         prevents it from being added to this queue</span>
<span class="cm">     */</span>
    <span class="kt">boolean</span> <span class="nf">offer</span><span class="o">(</span><span class="n">E</span> <span class="n">e</span><span class="o">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Retrieves and removes the head of this queue.  This method differs</span>
<span class="cm">     * from {@link #poll poll} only in that it throws an exception if this</span>
<span class="cm">     * queue is empty.</span>
<span class="cm">     *</span>
<span class="cm">     * @return the head of this queue</span>
<span class="cm">     * @throws NoSuchElementException if this queue is empty</span>
<span class="cm">     */</span>
    <span class="n">E</span> <span class="nf">remove</span><span class="o">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Retrieves and removes the head of this queue,</span>
<span class="cm">     * or returns {@code null} if this queue is empty.</span>
<span class="cm">     *</span>
<span class="cm">     * @return the head of this queue, or {@code null} if this queue is empty</span>
<span class="cm">     */</span>
    <span class="n">E</span> <span class="nf">poll</span><span class="o">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Retrieves, but does not remove, the head of this queue.  This method</span>
<span class="cm">     * differs from {@link #peek peek} only in that it throws an exception</span>
<span class="cm">     * if this queue is empty.</span>
<span class="cm">     *</span>
<span class="cm">     * @return the head of this queue</span>
<span class="cm">     * @throws NoSuchElementException if this queue is empty</span>
<span class="cm">     */</span>
    <span class="n">E</span> <span class="nf">element</span><span class="o">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Retrieves, but does not remove, the head of this queue,</span>
<span class="cm">     * or returns {@code null} if this queue is empty.</span>
<span class="cm">     *</span>
<span class="cm">     * @return the head of this queue, or {@code null} if this queue is empty</span>
<span class="cm">     */</span>
    <span class="n">E</span> <span class="nf">peek</span><span class="o">();</span>
</pre></div>


<h3 id="_9">使用例子</h3>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Queue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;&gt;();</span>
    <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
    <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
    <span class="k">while</span><span class="o">(!</span><span class="n">queue</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()){</span>
        <span class="n">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/* output</span>
<span class="cm">1</span>
<span class="cm">null</span>
<span class="cm">2</span>
<span class="cm">*/</span>
</pre></div>


<h2 id="dequeinterface-queue">Deque(interface) 双向队列，继承了Queue</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Deque</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Queue</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h2 id="arraylistclass">ArrayList(class) 数组</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
        <span class="kd">implements</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">RandomAccess</span><span class="o">,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span>
<span class="o">{</span>
</pre></div>


<h2 id="linkedlistclasslist-deque">LinkedList(class)链表(同时实现了List 和 Deque接口)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">AbstractSequentialList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">Deque</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span>
<span class="o">{</span>
</pre></div>


<h3 id="node">内部的Node结构(双向链表)</h3>
<div class="hlcode"><pre><span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="n">E</span> <span class="n">item</span><span class="o">;</span>
    <span class="n">Node</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>
    <span class="n">Node</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">prev</span><span class="o">;</span>

    <span class="n">Node</span><span class="o">(</span><span class="n">Node</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">prev</span><span class="o">,</span> <span class="n">E</span> <span class="n">element</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="n">element</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">prev</span> <span class="o">=</span> <span class="n">prev</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h2 id="vectorclass">Vector(class)线程安全的数组</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Vector</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">AbstractList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">RandomAccess</span><span class="o">,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span>
<span class="o">{</span>
</pre></div>


<h3 id="synchronized_1">线程安全,操作方法基本加上了<code>synchronized</code>关键字</h3>
<h2 id="priorityqueueclass">PriorityQueue(class) 优先队列</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractQueue</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{</span>
</pre></div>


<h3 id="_10">实例</h3>
<div class="hlcode"><pre><span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">comparator</span> <span class="o">=</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)-&gt;{</span>
    <span class="kt">int</span> <span class="n">va</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span><span class="n">a</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">vb</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span><span class="n">b</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">va</span> <span class="o">&gt;</span> <span class="n">vb</span><span class="o">){</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">va</span> <span class="o">&lt;</span> <span class="n">vb</span><span class="o">){</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">};</span>
<span class="n">Queue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PriorityQueue</span><span class="o">(</span><span class="n">comparator</span><span class="o">);</span>
<span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
<span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
<span class="k">while</span> <span class="o">(!</span><span class="n">queue</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()){</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">queue</span><span class="o">.</span><span class="na">poll</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>


<h2 id="stackclass">Stack(class)</h2>
<div class="hlcode"><pre><span class="kd">public</span>
<span class="kd">class</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h3 id="vector">继承了Vector, 基于数组，线程安全</h3>
<div class="hlcode"><pre><span class="kd">public</span>
<span class="kd">class</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Creates an empty Stack.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="nf">Stack</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Pushes an item onto the top of this stack. This has exactly</span>
<span class="cm">     * the same effect as:</span>
<span class="cm">     * &lt;blockquote&gt;&lt;pre&gt;</span>
<span class="cm">     * addElement(item)&lt;/pre&gt;&lt;/blockquote&gt;</span>
<span class="cm">     *</span>
<span class="cm">     * @param   item   the item to be pushed onto this stack.</span>
<span class="cm">     * @return  the &lt;code&gt;item&lt;/code&gt; argument.</span>
<span class="cm">     * @see     java.util.Vector#addElement</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">E</span> <span class="nf">push</span><span class="o">(</span><span class="n">E</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">addElement</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes the object at the top of this stack and returns that</span>
<span class="cm">     * object as the value of this function.</span>
<span class="cm">     *</span>
<span class="cm">     * @return  The object at the top of this stack (the last item</span>
<span class="cm">     *          of the &lt;tt&gt;Vector&lt;/tt&gt; object).</span>
<span class="cm">     * @throws  EmptyStackException  if this stack is empty.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="n">E</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">E</span>       <span class="n">obj</span><span class="o">;</span>
        <span class="kt">int</span>     <span class="n">len</span> <span class="o">=</span> <span class="n">size</span><span class="o">();</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">peek</span><span class="o">();</span>
        <span class="n">removeElementAt</span><span class="o">(</span><span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Looks at the object at the top of this stack without removing it</span>
<span class="cm">     * from the stack.</span>
<span class="cm">     *</span>
<span class="cm">     * @return  the object at the top of this stack (the last item</span>
<span class="cm">     *          of the &lt;tt&gt;Vector&lt;/tt&gt; object).</span>
<span class="cm">     * @throws  EmptyStackException  if this stack is empty.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="n">E</span> <span class="nf">peek</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span>     <span class="n">len</span> <span class="o">=</span> <span class="n">size</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">EmptyStackException</span><span class="o">();</span>
        <span class="k">return</span> <span class="nf">elementAt</span><span class="o">(</span><span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Tests if this stack is empty.</span>
<span class="cm">     *</span>
<span class="cm">     * @return  &lt;code&gt;true&lt;/code&gt; if and only if this stack contains</span>
<span class="cm">     *          no items; &lt;code&gt;false&lt;/code&gt; otherwise.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">empty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the 1-based position where an object is on this stack.</span>
<span class="cm">     * If the object &lt;tt&gt;o&lt;/tt&gt; occurs as an item in this stack, this</span>
<span class="cm">     * method returns the distance from the top of the stack of the</span>
<span class="cm">     * occurrence nearest the top of the stack; the topmost item on the</span>
<span class="cm">     * stack is considered to be at distance &lt;tt&gt;1&lt;/tt&gt;. The &lt;tt&gt;equals&lt;/tt&gt;</span>
<span class="cm">     * method is used to compare &lt;tt&gt;o&lt;/tt&gt; to the</span>
<span class="cm">     * items in this stack.</span>
<span class="cm">     *</span>
<span class="cm">     * @param   o   the desired object.</span>
<span class="cm">     * @return  the 1-based position from the top of the stack where</span>
<span class="cm">     *          the object is located; the return value &lt;code&gt;-1&lt;/code&gt;</span>
<span class="cm">     *          indicates that the object is not on the stack.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">int</span> <span class="nf">search</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">lastIndexOf</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">size</span><span class="o">()</span> <span class="o">-</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** use serialVersionUID from JDK 1.0.2 for interoperability */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1224463164541339165L</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<h2 id="setinterface">Set(interface)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h2 id="hashsetclass">HashSet(class)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">AbstractSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span>
<span class="o">{</span>
</pre></div>


<h3 id="hashmap-key">底层基于 HashMap, key不同</h3>
<div class="hlcode"><pre><span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5024744406713321676L</span><span class="o">;</span>

<span class="kd">private</span> <span class="kd">transient</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">E</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">;</span>

<span class="c1">// Dummy value to associate with an Object in the backing Map</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Object</span> <span class="n">PRESENT</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>

<span class="cm">/**</span>
<span class="cm">    * Constructs a new, empty set; the backing &lt;tt&gt;HashMap&lt;/tt&gt; instance has</span>
<span class="cm">    * default initial capacity (16) and load factor (0.75).</span>
<span class="cm">    */</span>
<span class="kd">public</span> <span class="nf">HashSet</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="o">}</span>
</pre></div>


<h3 id="null-hasmapnull-key">允许元素为null (因为HasMap允许null key)</h3>
<div class="hlcode"><pre><span class="n">Set</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;();</span>
<span class="n">se</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="n">se</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">se</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">val</span><span class="o">-&gt;{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">val</span><span class="o">);</span>
<span class="o">});</span>
</pre></div>


<h2 id="linkedhashsetclass">LinkedHashSet(class)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedHashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">extends</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{</span>
</pre></div>


<h3 id="set">具有set集合不重复的特点，同时具有可预测的迭代顺序</h3>
<h3 id="_11">非线程安全</h3>
<h2 id="sortedsetinterface">SortedSet(interface)</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SortedSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h2 id="navigablesetinterface-sortedset">NavigableSet(interface) 继承 SortedSet</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NavigableSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">SortedSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</pre></div>


<h2 id="treesetclass-sortedset">TreeSet(class) 唯一实现了SortedSet的</h2>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
    <span class="kd">implements</span> <span class="n">NavigableSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span>
<span class="o">{</span>
</pre></div>


<h3 id="null">不允许 null 值</h3>
<h3 id="_12">非线程安全，树结构</h3>
<p>可以由<code>TreeMap</code>实现</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2019 doctording.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2019-12-14 21:38:42</p>
      </span>
    </div>

    
    
  </body>
</html>